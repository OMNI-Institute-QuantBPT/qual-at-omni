{"title":"Cleaning Qualitative Data in R Guide","markdown":{"yaml":{"title":"Cleaning Qualitative Data in R Guide","subtitle":"","author":"Hannah","date":"`r Sys.Date() |> format('%B %d, %Y')`","output":{"omni::omni_html_report":{"hypothesis":false}},"editor_options":{"chunk_output_type":"console","markdown":{"wrap":72}}},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(fig.path='figs/',\n                      echo=FALSE, # change to TRUE if most code chunks should knit to report \n                      warning=FALSE, \n                      message=FALSE)\n```\n\n```{r packages, echo=FALSE}\nlibrary(tidyverse)\nlibrary(omni)\nlibrary(flextable)\nlibrary(janeaustenr) # jane austen books\n\ntext <- austen_books()\n```\n\nManager's Summary\n\nData Cleaner's Summary\n\n\n**Do not share this guide outside of OMNI**\n\nData cleaning is often one of the first things you will do when you\nstart working with qualitative data at OMNI. Whether weâ€™re working with\ninterview transcripts, focus group discussions, or open-ended survey\nresponses, the raw data we receive is rarely ready for immediate\nanalysis. Cleaning is not just about tidying up; itâ€™s about making\ninformed decisions that clarify the meaning and integrity of the data\nwhile preparing it for systematic analysis.\n\nThe decisions we make during the cleaning process are every bit as\ncomplex and impactful as those made during coding and analysis.\nThoughtful data cleaning can preserve the richness of qualitative data,\nwhile careless decisions can distort or diminish participants' voices.\nTherefore, it is especially important to have a strong set of working\nprinciples to guide your decisions when cleaning qualitative data.\n\nThis guide covers a general approach to qualitative data cleaning, with\nan emphasis on useful R packages and functions designed to conquer some\ncommon challenges. While this guide includes tools and code to make your\nlife easier, it also offers guidelines for making judgment calls about\nwhat to remove, retain, or clarify in the data.\n\nThe steps in a qualitative data cleaning process will always be informed\nby two key factors:\n\n1)  **The state of the data when we (OMNI) receive it**\n\n-   For example, some transcripts may come from automated services (like\n    Zoom or Otter.ai) and contain timestamps, speaker labels, or filler\n    words that require removal. Others may be professionally transcribed\n    and need minimal cleaning.\n\n2)  **The specific needs of the project** Because of this variability,\n    we encourage a flexible, judgment-driven approach to data cleaning.\n    The steps described in this guide are common to many projects, but\n    their order and application should be tailored to the needs of the\n    dataset and the analytic goals of the project. Importantly,\n    depending on the type of analysis, different cleaning steps may be\n    required. Consult the analysis plan and research questions in your\n    project materials to verify the needs of the project.\n\n### Supporting resources\n\n## Rationale\n\nWhen we clean qualitative data, we apply a series of thoughtful\ntransformations that make the data clearer, more consistent, and usable\nfor analysis. Qualitative data cleaning requires attention to detail and\nsensitivity to the context in which the data were collected. The\nprocedures we use need to be flexible because the downstream purposes of\nthe data can vary from project to projectâ€”whether for thematic coding,\ncontent analysis, or mixed-methods integration.\n\nThe qualitative data cleaner often has to make many judgment calls\nduring this process. These decisions are guided by the projectâ€™s goals,\nthe nature of the source data, team experience, and guidance documents\n(like this one). Every decision and its rationale should be clearly\ndocumented in the data cleaning script or data log (more on that below).\nTransparency in this process ensures that the cleaned dataset remains\ntrustworthy and aligned with our ethical standards for qualitative\nresearch.\n\nQualitative data cleaning requires a lot of careful thought and\nattention. The R code that cleans text data needs to be clearly written\nand well-commented, not only for reproducibility but to ensure that\nmeaning is preserved, and participant voices are not inadvertently\naltered or diminished. In qualitative work, the cleaning process can\ndirectly impact the integrity of the analysis.\n\nJust as with quantitative analysis, qualitative data-cleaning decisions\nare made with greater ease and clarity when there is a clear work plan,\nguided by the projectâ€™s research questions or evaluation goals. Having a\nshared understanding of what the team hopes to explore in the data helps\ninform:\n\nWhat should be cleaned What should be preserved (even if messy) What\nshould be flagged for discussion Two especially helpful documents to\nhave before qualitative data cleaning begins are:\n\nA codebook (or at least a data dictionary) This helps ensure consistency\nin how we treat things like speaker names, special terminology, or\nsensitive content. A data analysis plan This outlines the teamâ€™s\napproach to coding and analysis and helps identify if additional\ncleaning steps are necessary. For example: anonymizing sensitive details\nor removing artifacts from automated transcription tools (timestamps,\nfiller words, etc.). Whenever possible, we expect teams to develop a\ndata analysis plan and request any available data dictionaries or\ncodebooks from the client or partner organizations who collected the\ndata. However, you may need to create a codebook if one doesnâ€™t\nexistâ€”feel free to reach out to the QualBPT (or whichever team you want\nto point folks to) if you need support.\n\nIn many cases, the people drafting the analysis plan are different from\nthose cleaning the qualitative data, so strong cross-team communication\nis essential. We recommend including the qualitative data cleaner (or\ncleaning team) in project discussions as early as possible. When\ndrafting the analysis plan, think through what text cleaning steps will\nbe necessary to make the data usable for coding, protect participant\nconfidentiality, and meet the projectâ€™s goals.\n\nFinally, whether youâ€™re writing code for qualitative data cleaning or\nany other purpose, always write your R scripts as if they will later be:\n\n-   Heavily scrutinized\n-   Held up as example code\n-   Modified by someone brand new to both R and the project\n\nMake it easy on future OMNI-itesâ€”and on your future self!\n\n## When are data clean?\n\nâœ… What Does It Mean to Have \"Clean\" Qualitative Data? For there to be\nproject tasks that direct OMNI-ites to â€˜clean qualitative data,â€™ and a\nguide to help in doing so, there should also be a shared understanding\nof what it means for qualitative data to be clean.\n\nðŸ“ Definition of Clean Qualitative Data: At OMNI, qualitative data are\nconsidered clean when they are organized, de-identified, and ready for\nanalysis or coding.\n\nThat means the data:\n\nAccurately reflect the original source material (e.g., interviews, focus\ngroups, or open-text survey responses) Have been transformed into a\nstructure that makes them easy to navigate and analyze Protect the\nprivacy and confidentiality of participants Are consistent, clear, and\nfree of irrelevant clutter (like transcription artifacts) ðŸŽ¯ What Makes\na Qualitative Dataset \"Analysis-Ready\"? For qualitative text data to be\nready for analysis, they should meet the following criteria:\n\nSpeaker Information Is Clear and Consistent\n\nParticipant speakers and interviewers are clearly labeled in the data.\nEach speakerâ€™s text is grouped logically into segments, preserving\nconversational flow. Participant Identifiers Are Specified and Protected\n\nReal names, locations, and other direct identifiers have been removed or\nreplaced with participant IDs or pseudonyms. Confidential information\n(e.g., agency names, job titles, organizations) is anonymized where\nnecessary, following OMNIâ€™s confidentiality guidelines. Questions Are\nClearly Distinguished From Responses\n\nInterviewer questions (or prompts) are labeled or separated from\nparticipant responses, as appropriate. This can be done by adding\nquestion text as its own field in the dataset or by adding markers in\nthe transcript. Text Segments Are Ordered and Organized\n\nThe transcript text is ordered according to the flow of conversation.\nSegments are correctly time-sequenced (even if timestamps themselves are\nremoved). Text Is Structured Into a Tidy, Rectangular Format\n\nEach row represents a single speaker turn or unit of analysis (e.g., a\ncomplete response to a question). Data are stored in a rectangular table\n(data frame), with columns for: Session name or group (e.g., \"Educators\"\nor \"Public Health\") Participant ID or role (e.g., \"Participant 1,\"\n\"Facilitator\") Text segment (the response or comment) Any relevant\nmetadata (e.g., discussion section, date) Timestamps and Transcription\nArtifacts Are Removed\n\nAll timestamps (e.g., [00:05:23], (0:12:45)) are deleted unless\nspecifically required for analysis. Automated transcription quirks\n(e.g., repeated words, filler words, auto-captions like â€œ[inaudible]â€)\nare reviewed, cleaned, or flagged. Text Is Consistent in Style and\nFormat\n\nAll text is converted to lowercase, unless case is important for\nanalysis. Spelling errors are corrected when they obscure meaning (but\nregional spellings or participant quirks may be preserved if relevant).\nPunctuation and spacing are standardized (no excessive whitespace,\nmissing periods, etc.). Relevant Identifiers Are Added to the Dataset\n\nIf there are multiple sessions or groups, these are labeled (e.g.,\n\"Educators,\" \"Public Health\"). If there are themes or discussion\nsections (e.g., \"Challenges,\" \"Recommendations\"), these are identified.\nIf codes are pre-assigned for analytic purposes (e.g.,\nâ€œPre-implementation,â€ â€œPost-implementationâ€), they are included in the\ndata structure. ðŸ’¡ How Do We Know When Qualitative Data Are Clean? Here\nare some guiding questions to help determine when qualitative data are\nready for analysis (i.e., clean):\n\nWhat is the plan for coding or analyzing this data?\n\nThe analysis plan (or coding framework) should inform cleaning\ndecisions. For example, if the team plans to do thematic coding, theyâ€™ll\nneed text organized into meaningful speaker turns or responses. What\nneeds to be anonymized?\n\nIdentify any sensitive information that must be redacted or replaced to\nmaintain confidentiality and ensure participant privacy. Are speaker\nturns properly attributed and easy to follow?\n\nEach speakerâ€™s contributions should be clearly labeled, consistently\nformatted, and grouped logically. Are responses to specific questions\nclearly identifiable?\n\nIf interviews or focus groups follow a semi-structured guide, itâ€™s\nimportant to separate questions from responses for clarity in analysis.\nIs the structure of the data appropriate for the analytic tool?\n\nIf the data are being uploaded to Dedoose, NVivo, or another platform,\nthey should follow the required format (e.g., tidy data frame with\nspeaker IDs and group names). Have all unnecessary artifacts been\nremoved?\n\nTime stamps, filler words, and transcription errors that donâ€™t add value\nto the analysis should be removed. Has the cleaned data been reviewed by\nsomeone else (QA check)?\n\nWhenever possible, have another OMNI-ite review the cleaned data for\naccuracy and completeness. âœ¨ Common Issues to Discuss Early in the\nCleaning Process Just like in quantitative data cleaning, clarifying\nexpectations at the start of a project will save time later. For\nqualitative projects, consider these:\n\nWill we analyze both facilitator questions and participant responses, or\njust participant responses? How will we handle overlapping speech,\ninterruptions, or incomplete thoughts? Do we need to standardize\nparticipant roles (e.g., \"Public Health Official\" vs. \"PH Staff\") for\nconsistency? Are we preparing data for manual coding or automated text\nanalysis? Do we need to translate or transcribe non-English responses?\nDo we need to connect text segments with broader context, such as the\ndiscussion theme or section of the focus group? ðŸš€ In the Following\nSections... Weâ€™ll see how these fundamentalsâ€”like tidy qualitative data,\npipes, and regular expressionsâ€”play out in real-world cleaning tasks,\nsuch as:\n\nRemoving timestamps and filler words Labeling speakers and organizing\nsegments Anonymizing sensitive information Structuring text for analysis\nsoftware (Dedoose, NVivo, etc.) âœ… Quick Summary of \"Clean Qualitative\nData\" at OMNI: Clean qualitative data are:\n\nAnonymized Clearly structured and labeled Organized for easy analysis\nFree of unnecessary artifacts Ready for use in coding and interpretation\n\n## How do I report the results of data cleaning?\n\nðŸ“ How to Report the Results of Qualitative Data Cleaning at OMNI\nCleaning qualitative data is an interpretive and decision-heavy process,\nand those decisions need to be transparent. Reporting your cleaning\nprocess helps:\n\nProject leads understand whatâ€™s been done and why. Provide documentation\nin case changes need to be made later. Build trust in the integrity of\nthe cleaned dataset. Support future qualitative coding, interpretation,\nand reporting. Qualitative data cleaning produces resultsâ€”changes to the\ntext or data structureâ€”that should be documented in a clear, shareable\ndata cleaning report.\n\nðŸ“‹ What to Include in a Qualitative Data Cleaning Report 1. Summary of\nthe Dataset You Cleaned Start with an overview:\n\nHow many transcripts or files were cleaned? How many sessions (e.g.,\nfocus groups, interviews) are included? What types of participants are\nrepresented (e.g., educators, public health professionals)? Example:\nThis dataset includes transcripts from 8 focus groups, with 42\nparticipants. Participants represent two stakeholder groups: Educators\n(n = 20) and Public Health Professionals (n = 22).\n\n2.  Anonymization and De-Identification Steps Document what you removed\n    or replaced to protect confidentiality.\n\nWere participant names replaced with IDs (e.g., Participant 01)? Were\norganizations, locations, or personal identifiers removed or redacted?\nWere job titles generalized (e.g., â€œCEOâ€ changed to â€œsenior leaderâ€)?\nExample: Replaced all participant names with Participant IDs (e.g.,\nP01). Removed specific references to organizations and locations (e.g.,\nâ€œat Boulder Community Hospitalâ€ becomes â€œat [hospital]â€). Redacted job\ntitles for anonymity when mentioned alongside unique organizations.\n\n3.  Speaker Labeling and Text Structuring Describe how speakers were\n    labeled and how the transcript was organized.\n\nWere speakers consistently labeled as \"Participant\" and \"Facilitator\"?\nWas each speaker turn separated into its own row or segment? Were\nquestions separated from responses? Example: Speaker turns were labeled\nconsistently as either Facilitator or Participant. Each speaker turn is\nstored as one row in the cleaned dataset, with associated metadata\n(Session name, Speaker role, Discussion section).\n\n4.  Artifacts Removed (Timestamps, Filler Words, etc.) Note what\n    transcription artifacts were removed or edited:\n\nWere timestamps deleted? Were filler words (e.g., â€œum,â€ â€œuhâ€) removed?\nIf so, specify whether this was systematic or case-by-case. Were\ntranscription errors corrected? Example: Removed all timestamps in the\nformat [hh:mm:ss]. Deleted common filler words (â€œum,â€ â€œuhâ€) unless they\ncontributed to participant meaning or tone. Reviewed and corrected\nauto-transcription errors (e.g., â€œDodooseâ€ corrected to â€œDedooseâ€).\n\n5.  Text Standardization and Formatting Summarize standardization steps\n    for readability and consistency:\n\nWas text converted to lowercase? Was spelling corrected? If so, did you\npreserve participant colloquialisms? Were consistent punctuation and\nspacing applied? Example: Converted all text to lowercase for\nconsistency. Standardized punctuation (e.g., added periods to sentence\nends where missing). Corrected spelling errors that obscured meaning but\npreserved participant vernacular and tone where appropriate.\n\n6.  Metadata or Contextual Information Added Note any metadata added to\n    support analysis:\n\nSession name (e.g., â€œEducatorsâ€ vs. â€œPublic Health Professionalsâ€)\nDiscussion section (e.g., â€œChallenges,â€ â€œRecommendationsâ€) Participant\nrole or group designation Example: Added metadata fields to identify\nSession Name, Participant Group (Educator/Public Health), and Discussion\nSection (Barriers, Facilitators, Recommendations).\n\n7.  Key Decisions Made During Cleaning Flag any important decisions that\n    could impact analysis:\n\nIf you excluded any portions of text (e.g., off-topic discussions),\ndocument what was excluded and why. If you made choices about retaining\nor removing interruptions, overlapping speech, or non-verbal cues,\ndescribe the rationale. If you generalized identifying details in ways\nthat may impact interpretation, note this. Example: Excluded\nintroductory small talk (greetings, logistics discussions) from the\nanalysis dataset. Retained overlapping speech where relevant to the\ndiscussion. Generalized certain job titles to preserve anonymity (e.g.,\nâ€œHead Nurseâ€ changed to â€œMedical Staffâ€).\n\n8.  Counts and Summaries Where Relevant When helpful, include counts\n    that summarize:\n\nHow many identifiers were removed? How many sessions, speakers, or\nresponses are in the final dataset? If you organized by themes, how many\nsegments are in each theme? Example: Final cleaned dataset includes 8\nfocus groups, 42 participants, and 620 participant responses across\nthree discussion sections: Challenges (n = 220), Facilitators (n = 200),\nand Recommendations (n = 200).\n\nðŸ’¡ Tips for Reporting Qualitative Data Cleaning Be Transparent Even\nsmall decisions (e.g., standardizing speaker labels) can have big\nimplications during analysis. If youâ€™re unsure whether to document\nsomething, document it!\n\nTake the Perspective of Your Project Lead or Analyst What decisions\nmight they need to revisit later? What context would help them\nunderstand how the data were shaped?\n\nSupport Replicability and Quality Control Your cleaning report should\nmake it easy for another team member to:\n\nUnderstand what was done Re-run the cleaning script Suggest or request\nchanges with full knowledge of the process ðŸ–¼ï¸ Example Summary Table in a\nQualitative Cleaning Report Cleaning Step Action Taken Notes\nAnonymization Removed names, replaced with Participant IDs (P01-P42)\nLocations and job titles generalized Speaker Labeling Labeled as\nFacilitator or Participant Consistent across all sessions Timestamps\nRemoved Deleted all timestamps (hh:mm:ss)\\\nFiller Words Removed \"um,\" \"uh\" except when indicating hesitation\nCase-by-case review Text Standardization Converted to lowercase,\ncorrected major spelling errors Preserved participant language/tone\nMetadata Added Session name, participant group, discussion section\nUseful for subgroup analysis Exclusions Removed introductions, off-topic\ndiscussions Documented in the data log\n\n## Terminology\n\nðŸ“ Relevant Terminology for Qualitative Data Cleaning in R ðŸ”§ Data\nStructure & Format Terms Transcript A written or typed record of spoken\nlanguage from interviews, focus groups, or meetings. Transcripts may\ninclude speaker labels, timestamps, and other artifacts that need\ncleaning.\n\nTurn-Taking Each time a participant or facilitator speaks is called a\n\"turn.\" Clean data often organize these turns into individual rows in a\ndataset.\n\nSegment (or Excerpt) A portion of text, such as a paragraph, sentence,\nor speaker turn, treated as a unit for coding or analysis. Segments are\noften defined by the speaker's response or by topic.\n\nTidy Data Data where:\n\nEach row represents a single observation (e.g., a speaker turn or\nsegment) Each column contains one type of information (e.g., speaker ID,\ntext, session group) Tidy data make it easier to manipulate, clean, and\nanalyze qualitative datasets in R. Rectangular Data Another term for a\ntable or data frame, where rows and columns are used to organize data in\nR.\n\nðŸ—‚ï¸ Qualitative Metadata & Labeling Terms Speaker Label An identifier\nshowing who is speaking (e.g., \"Facilitator,\" \"Participant 1\"). Clean\ndata should use consistent speaker labels.\n\nParticipant ID A unique identifier assigned to participants to protect\nanonymity (e.g., \"P01\"). These are often used in place of names.\n\nSession ID / Group The label identifying the specific interview or focus\ngroup a participant was part of (e.g., \"Session 1 â€“ Educators\").\n\nDiscussion Section / Topic Area A label identifying a portion of the\nconversation (e.g., \"Barriers,\" \"Recommendations\") to help organize\nqualitative data.\n\nâœ‚ï¸ Data Cleaning & Transformation Terms Anonymization /\nDe-Identification The process of removing or replacing personal\nidentifiers (e.g., names, locations, job titles) to protect participant\nprivacy.\n\nStandardization Making text consistent in format (e.g., converting to\nlowercase, consistent punctuation, spacing).\n\nTokenization (Optional depending on your analysis!) Breaking down text\ninto smaller partsâ€”words, sentences, or phrasesâ€”typically for text\nmining. Not always part of standard qualitative coding workflows.\n\nFiltering Removing unnecessary rows or segments (e.g., small talk,\noff-topic responses) from the data.\n\nRecoding Transforming data from one format to another (e.g.,\ngeneralizing job titles or grouping participant roles).\n\nJoin / Merge Combining two datasets based on a shared key (e.g., merging\nparticipant demographic info with transcripts).\n\nPivoting Restructuring data from wide format (many columns) to long\nformat (many rows), or vice versa, to make it easier to analyze or\ndisplay.\n\nðŸ·ï¸ Text Cleaning Terms Timestamps Time markers in transcripts (e.g.,\n[00:12:34]) that need to be removed unless necessary for the analysis.\n\nFiller Words Common speech disfluencies (e.g., \"um,\" \"uh,\" \"like\") that\ncan be removed for clarity, depending on analysis goals.\n\nInaudibles / Transcription Errors Markers like â€œ[inaudible]â€ or machine\ntranscription errors that need to be corrected or flagged.\n\nSpelling and Grammar Standardization Correcting spelling errors that\nmake text difficult to read, while preserving participant voice and tone\nwhere relevant.\n\n# Data cleaning procedures\n\nThe first step we'll need to take is to figure out what kind of document\nyou want to read into R.\n\n## Reading your data into R\n\nFirst, we'll need to read our data into R. Depending on how your raw\ntext is stored, you'll need to take various steps to read in your data\nfor analysis. The goal is to turn any of your text into a dataframe with\nrows and columns of your text responses. In some cases, you may need to\nkeep participant ID columns or other columns if you're doing a\nmixed-method analysis. In other cases, you may be analyzing different\nfocus groups and comparing them to eachother. Whatever you are doing,\nmake sure your dataframe is set up or your analysis. If you are unsure\nabout this, ask Hannah or a member of Qual BPT for some help!\n\nHere is an example of what your data may look like when you first read\nit into R.\n\n![](dirty_data.png)\n\nand here's what we want it to look like (eventually) for most of our\nanalysis needs.\n\n![](clean_data.png)\n\nWith clean data, we can:\n\n-   Compare participants' responses across sessions and discussion\n    sections. We could answer questions like:\n\n    -   What did Educators say about Community Impact vs. Public\n        Health?\"\n\n    -   What did participants across all interviews think about\n        abatement funds?\n\n-   Filter by participant role (e.g., facilitators vs. participants) for\n    targeted analysis. We could answer questions like:\n\n    -    How many participants mentioned that the county should invest\n        in wraparound services across all interviews?\n\n    -   What is the most common barrier in accessing services in the\n        county?\n\n-   Preserve anonymity by removing names and identifiers.\n\n### Zoom transcripts\n\nOne of the main forms of qualitative data we receive includes Zoom transcripts. Below is a function you can use to clean your Zoom transcripts and get them to a tidy format by entering the interviewer name(s), and key phrases used by the interviewer to mark the section of the discussion. For example, an interview might begin with an introduction, then include a discussion of barriers, and a discussion of strengths. We'll likely want to separate these out into sections so our analyses can speak to each section independent of each other, rather than be clumped altogether. \n\n```{r}\n\n# youll need these libraries for this function:\nlibrary(tidyverse)\nlibrary(officer)\nlibrary(stringr)\n\nclean_transcript <- function(file_path,\n                             file_type = c(\".docx\", \".txt\"),\n                             interviewers,\n                             question_list,\n                             section_labels,\n                             session_name) {\n  \n  # Match file_type argument\n  file_type <- match.arg(file_type)\n  \n  # ================================\n  # âœ… 1. Load transcript based on file_type\n  # ================================\n  if (file_type == \".docx\") {\n    doc <- read_docx(file_path)\n    text_data <- docx_summary(doc)\n    df <- text_data %>%\n      dplyr::select(line = doc_index, text)\n  } else if (file_type == \".txt\") {\n    text_lines <- readLines(file_path, encoding = \"UTF-8\")\n    df <- tibble(line = seq_along(text_lines), text = text_lines)\n  } else {\n    stop(\"Unsupported file type. Use '.docx' or '.txt'\")\n  }\n\n  # ================================\n  # âœ… 2. Classify speaker: interviewer vs participant\n  # ================================\n  df <- df %>%\n    mutate(\n      speaker = case_when(\n        str_detect(text, str_c(interviewers, collapse = \"|\")) ~ \"interviewer\",\n        TRUE ~ \"participant\"\n      )\n    ) %>%\n    filter(\n      text != \"\",                      # Remove blank rows\n      !str_detect(text, \"^\\\\d+$\"),     # Remove number-only rows\n      !str_detect(text, \"-->\")         # Remove timestamp markers\n    )\n\n  # ================================\n  # âœ… 3. Extract participant & interviewer names\n  # ================================\n  \n  # Participants\n  unique_participants <- df %>%\n    filter(speaker == \"participant\" & str_detect(text, \":\")) %>%\n    mutate(participant_name = str_extract(text, \"^[^:]+\")) %>%\n    distinct(participant_name) %>%\n    drop_na() %>%\n    mutate(participant_id = paste0(\"P\", row_number()))\n\n  # Assign participant IDs back\n  df <- df %>%\n    mutate(\n      participant_name = if_else(\n        speaker == \"participant\" & str_detect(text, \":\"),\n        str_extract(text, \"^[^:]+\"),\n        NA_character_\n      )\n    ) %>%\n    left_join(unique_participants, by = \"participant_name\") %>%\n    select(-participant_name)\n\n  # Interviewers\n  unique_interviewers <- df %>%\n    filter(speaker == \"interviewer\" & str_detect(text, \":\")) %>%\n    mutate(interviewer_name = str_extract(text, \"^[^:]+\")) %>%\n    distinct(interviewer_name) %>%\n    drop_na() %>%\n    mutate(interviewer_id = paste0(\"I\", row_number()))\n\n  # Assign interviewer IDs back\n  df <- df %>%\n    mutate(\n      interviewer_name = if_else(\n        speaker == \"interviewer\" & str_detect(text, \":\"),\n        str_extract(text, \"^[^:]+\"),\n        NA_character_\n      )\n    ) %>%\n    left_join(unique_interviewers, by = \"interviewer_name\") %>%\n    mutate(\n      participant_id = coalesce(participant_id, interviewer_id)\n    ) %>%\n    select(-interviewer_name, -interviewer_id)\n\n  # ================================\n  # âœ… 4. Clean and Preprocess Text\n  # ================================\n  df <- df %>%\n    mutate(\n      text = str_remove(text, \".*?:\\\\s*\"),   # Remove speaker names (before colon)\n      text = tolower(text),                  # Convert to lowercase\n      text = str_replace_all(text, \"[^a-zA-Z0-9\\\\s]\", \"\"),  # Remove special characters (except spaces)\n      text = iconv(text, from = \"UTF-8\", to = \"ASCII//TRANSLIT\")  # Convert non-ASCII characters\n    )\n\n  # ================================\n  # âœ… 5. Create speaker segments BEFORE detecting questions\n  # ================================\n  df <- df %>%\n    arrange(line) %>%\n    filter(!is.na(participant_id)) %>%\n    mutate(\n      group_id = cumsum(\n        participant_id != lag(participant_id, default = first(participant_id))\n      )\n    ) %>%\n    group_by(group_id) %>%\n    summarize(\n      across(-text, first),                # Keep first of all other columns\n      text = str_c(text, collapse = \" \"),  # Collapse text\n      .groups = \"drop\"\n    ) %>%\n    arrange(line)\n\n  # ================================\n  # âœ… 6. Detect interviewer questions\n  # ================================\n  df <- df %>%\n    mutate(\n      question = if_else(\n        speaker == \"interviewer\" &\n          str_detect(\n            text,\n            regex(str_c(question_list, collapse = \"|\"), ignore_case = TRUE)\n          ),\n        1L,\n        0L\n      )\n    )\n\n  # ================================\n  # âœ… 7. Remove text before first question\n  # ================================\n  first_question_line <- min(df$line[df$question == 1], na.rm = TRUE)\n  \n  df <- df %>%\n    filter(line >= first_question_line)\n\n  # ================================\n  # âœ… 8. Assign section numbers\n  # ================================\n  df <- df %>%\n    mutate(section = cumsum(question == 1))\n\n  # Map section numbers to section labels\n  section_map <- tibble(\n    section = seq_along(section_labels),\n    section_label = section_labels\n  )\n\n  # Join section labels\n  df <- df %>%\n    left_join(section_map, by = \"section\")\n\n  # ================================\n  # âœ… 9. Remove interviewer lines AFTER section labels assigned\n  # ================================\n  df <- df %>%\n    filter(speaker != \"interviewer\") %>%\n    mutate(session = session_name)\n\n  # ================================\n  # âœ… 10. Return final dataframe\n  # ================================\n  final_df <- df %>%\n    select(\n      line,\n      speaker,\n      participant_id,\n      question,\n      section,\n      section_label,\n      text,\n      session\n    )\n\n  return(final_df)\n}\n\n```\n\nAnd when you want to clean the transcripts and mark the interviewer, you can add the names of the interviewers here. \n\nThis function works for Zoom transcripts that are saved as Word documents or .txt files. There are few things you need to specify in the function, including updating the file path, the interviewers, setting your list of questions, adding section labels, and the session name. \n\nThis example comes from the Loudoun County Opioid Abatement project where Shon, Lindsay, Hannah, Luke, Eden, and Arden are staffed, so any of them could have been an interviewer. \n\n@QUALBPT is there anything listed here that may be helpful to add that we might want to analyze or examine?\n@QUALBPT is there ever a case where we would need to analyze the interviewer's language?\n\nIn the case where an interviewer asks a question an exact way, we can enter the question as it is listed on the interview guide. However, this is not always the best way to run an interview when you're following a more relaxed vibe. So, it may be helpful to have the interview guide (or deck, whatever the interviewer used to facilitate the discussion) and the transcript opened to identify the order of discussion and section labels, and to identify where those key markers of the text are going to identify your questions. \n\nWhat is a good example of a question list if the interviewer did not read the question verbatim? Let's imagine the first question listed on the interview guide is \"What kinds of barriers do you think prevent community members from accessing services in the county?\". \n\nBad example: \"accessing services\" this is a bad example because this phrase has been marked as an identifier for a question, so any instance of \"accessing services\" comes up will count the phrase as a question.\n\nGood example: \"barriers do you think prevent community members from accessing services\" it is less likely for someone to have used this exact string of words in the conversation, so we're safe to mark this as a question identifier. \n\n```{r}\n# %%%%%%%%%%%%%%%%%%% List interviewer names %%%%%%%%%%%%%%%%%%%\n# ed_df <- clean_transcript(\n#   file_path      = \"../../../data_collection/Listening Sessions/Transcripts/Education Listening Session Transcript.docx\",\n#   file_type      = \".docx\",\n#   interviewers   = c(\"Shon Reed\", \"Lindsay Houston\", \n#                      \"Hannah Lunkenheimer\", \"Luke Saunders\", \n#                      \"Eden Griffin\", \"Sam Barron\",\n#                      \"Arden Trewartha\"),\n#   question_list  = c(\"1st question\", \n#                      \"how has the opioid crisis impacted schools and universities within Loudoun County\", \n#                      \"opioid abatement fund\",\n#                      \"what are what are other specific examples that are working well\",\n#                      \"current efforts on the treatment and recovery\",\n#                      \"are there any other strategies\",\n#                      \"vision for the future\",\n#                      \"survey that you can complete if you would like\"),\n#   section_labels = c(\"Data check\", \"Community impact\", \"Abatement funds\",\n#                      \"Prevention and harm reduction\", \"Treatment and recovery\",\n#                      \"Other strategies\", \"Vision for the future\", \"Next steps\"),\n#   session_name   = \"education\"\n# )\n\n```\n\n### PDFs\n\n```{r}\nlibrary(pdftools)\nlibrary(tibble)\nlibrary(dplyr)\n\n# # Define the folder where PDFs are saved\n# folder_path <- \"path/to/your/pdf/folder\"\n# \n# # List all PDF files in the folder\n# pdf_files <- list.files(folder_path, pattern = \"\\\\.pdf$\", full.names = TRUE)\n# \n# pdf_data <- pdf_files %>%\n#   map_df(~ tibble(\n#     file = basename(.x),           # Extract file name only\n#     text = paste(pdf_text(.x), collapse = \" \")  # Merge all pages into one text block\n#   ))\n# \n# # View the cleaned data\n# print(pdf_data)\n# \n# pdf_data <- pdf_data %>%\n#   mutate(text = str_replace_all(text, \"\\\\s+\", \" \"))  # Remove extra spaces/newlines\n# \n# print(pdf_data)\n\n\n```\n\n### Excel sheets\n\nOf course, we also tend to ask qualitative questions in some of our surveys at OMNI, and these types of data should be read in like quantitative data and should already be in a clean format if you follow the data cleaning guide (insert link to data cleaning guide).\n\n### @QUALBPT Any other forms of text we use?\n\n```{r}\n# %%%%%%%%%%%%%%% Fix misspelled words %%%%%%%%%%%%%%%\n\nlibrary(hunspell)\n\n# Flag misspelled words\nmisspelled <- cleaned_text %>%\n  mutate(\n    misspelled = !hunspell_check(word),\n    suggestions = map(word, hunspell_suggest)\n  ) %>%\n  filter(misspelled)\n\nhead(misspelled)\n\ncorrected_text <- cleaned_text %>%\n  mutate(word = case_match(\n    word, \n    \"leraning\" ~ \"learning\",\n    .default = word\n  ))\n\nhead(corrected_text)\n\n```\n\n\n# QA Checklist for Qual Cleaning\n\n[ ] Are participant and interviewer roles correctly labeled?\n[ ] Have names, locations, and job titles been de-identified?\n[ ] Are timestamps removed (unless needed for analysis)?\n[ ] Are discussion sections correctly labeled?\n[ ] Has text been standardized (case, punctuation, spacing)?\n[ ] Is the cleaned dataset in a tidy format (one speaker turn per row)?\n[ ] Has the cleaned dataset been reviewed by another team member?\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(fig.path='figs/',\n                      echo=FALSE, # change to TRUE if most code chunks should knit to report \n                      warning=FALSE, \n                      message=FALSE)\n```\n\n```{r packages, echo=FALSE}\nlibrary(tidyverse)\nlibrary(omni)\nlibrary(flextable)\nlibrary(janeaustenr) # jane austen books\n\ntext <- austen_books()\n```\n\nManager's Summary\n\nData Cleaner's Summary\n\n## Introduction\n\n**Do not share this guide outside of OMNI**\n\nData cleaning is often one of the first things you will do when you\nstart working with qualitative data at OMNI. Whether weâ€™re working with\ninterview transcripts, focus group discussions, or open-ended survey\nresponses, the raw data we receive is rarely ready for immediate\nanalysis. Cleaning is not just about tidying up; itâ€™s about making\ninformed decisions that clarify the meaning and integrity of the data\nwhile preparing it for systematic analysis.\n\nThe decisions we make during the cleaning process are every bit as\ncomplex and impactful as those made during coding and analysis.\nThoughtful data cleaning can preserve the richness of qualitative data,\nwhile careless decisions can distort or diminish participants' voices.\nTherefore, it is especially important to have a strong set of working\nprinciples to guide your decisions when cleaning qualitative data.\n\nThis guide covers a general approach to qualitative data cleaning, with\nan emphasis on useful R packages and functions designed to conquer some\ncommon challenges. While this guide includes tools and code to make your\nlife easier, it also offers guidelines for making judgment calls about\nwhat to remove, retain, or clarify in the data.\n\nThe steps in a qualitative data cleaning process will always be informed\nby two key factors:\n\n1)  **The state of the data when we (OMNI) receive it**\n\n-   For example, some transcripts may come from automated services (like\n    Zoom or Otter.ai) and contain timestamps, speaker labels, or filler\n    words that require removal. Others may be professionally transcribed\n    and need minimal cleaning.\n\n2)  **The specific needs of the project** Because of this variability,\n    we encourage a flexible, judgment-driven approach to data cleaning.\n    The steps described in this guide are common to many projects, but\n    their order and application should be tailored to the needs of the\n    dataset and the analytic goals of the project. Importantly,\n    depending on the type of analysis, different cleaning steps may be\n    required. Consult the analysis plan and research questions in your\n    project materials to verify the needs of the project.\n\n### Supporting resources\n\n## Rationale\n\nWhen we clean qualitative data, we apply a series of thoughtful\ntransformations that make the data clearer, more consistent, and usable\nfor analysis. Qualitative data cleaning requires attention to detail and\nsensitivity to the context in which the data were collected. The\nprocedures we use need to be flexible because the downstream purposes of\nthe data can vary from project to projectâ€”whether for thematic coding,\ncontent analysis, or mixed-methods integration.\n\nThe qualitative data cleaner often has to make many judgment calls\nduring this process. These decisions are guided by the projectâ€™s goals,\nthe nature of the source data, team experience, and guidance documents\n(like this one). Every decision and its rationale should be clearly\ndocumented in the data cleaning script or data log (more on that below).\nTransparency in this process ensures that the cleaned dataset remains\ntrustworthy and aligned with our ethical standards for qualitative\nresearch.\n\nQualitative data cleaning requires a lot of careful thought and\nattention. The R code that cleans text data needs to be clearly written\nand well-commented, not only for reproducibility but to ensure that\nmeaning is preserved, and participant voices are not inadvertently\naltered or diminished. In qualitative work, the cleaning process can\ndirectly impact the integrity of the analysis.\n\nJust as with quantitative analysis, qualitative data-cleaning decisions\nare made with greater ease and clarity when there is a clear work plan,\nguided by the projectâ€™s research questions or evaluation goals. Having a\nshared understanding of what the team hopes to explore in the data helps\ninform:\n\nWhat should be cleaned What should be preserved (even if messy) What\nshould be flagged for discussion Two especially helpful documents to\nhave before qualitative data cleaning begins are:\n\nA codebook (or at least a data dictionary) This helps ensure consistency\nin how we treat things like speaker names, special terminology, or\nsensitive content. A data analysis plan This outlines the teamâ€™s\napproach to coding and analysis and helps identify if additional\ncleaning steps are necessary. For example: anonymizing sensitive details\nor removing artifacts from automated transcription tools (timestamps,\nfiller words, etc.). Whenever possible, we expect teams to develop a\ndata analysis plan and request any available data dictionaries or\ncodebooks from the client or partner organizations who collected the\ndata. However, you may need to create a codebook if one doesnâ€™t\nexistâ€”feel free to reach out to the QualBPT (or whichever team you want\nto point folks to) if you need support.\n\nIn many cases, the people drafting the analysis plan are different from\nthose cleaning the qualitative data, so strong cross-team communication\nis essential. We recommend including the qualitative data cleaner (or\ncleaning team) in project discussions as early as possible. When\ndrafting the analysis plan, think through what text cleaning steps will\nbe necessary to make the data usable for coding, protect participant\nconfidentiality, and meet the projectâ€™s goals.\n\nFinally, whether youâ€™re writing code for qualitative data cleaning or\nany other purpose, always write your R scripts as if they will later be:\n\n-   Heavily scrutinized\n-   Held up as example code\n-   Modified by someone brand new to both R and the project\n\nMake it easy on future OMNI-itesâ€”and on your future self!\n\n## When are data clean?\n\nâœ… What Does It Mean to Have \"Clean\" Qualitative Data? For there to be\nproject tasks that direct OMNI-ites to â€˜clean qualitative data,â€™ and a\nguide to help in doing so, there should also be a shared understanding\nof what it means for qualitative data to be clean.\n\nðŸ“ Definition of Clean Qualitative Data: At OMNI, qualitative data are\nconsidered clean when they are organized, de-identified, and ready for\nanalysis or coding.\n\nThat means the data:\n\nAccurately reflect the original source material (e.g., interviews, focus\ngroups, or open-text survey responses) Have been transformed into a\nstructure that makes them easy to navigate and analyze Protect the\nprivacy and confidentiality of participants Are consistent, clear, and\nfree of irrelevant clutter (like transcription artifacts) ðŸŽ¯ What Makes\na Qualitative Dataset \"Analysis-Ready\"? For qualitative text data to be\nready for analysis, they should meet the following criteria:\n\nSpeaker Information Is Clear and Consistent\n\nParticipant speakers and interviewers are clearly labeled in the data.\nEach speakerâ€™s text is grouped logically into segments, preserving\nconversational flow. Participant Identifiers Are Specified and Protected\n\nReal names, locations, and other direct identifiers have been removed or\nreplaced with participant IDs or pseudonyms. Confidential information\n(e.g., agency names, job titles, organizations) is anonymized where\nnecessary, following OMNIâ€™s confidentiality guidelines. Questions Are\nClearly Distinguished From Responses\n\nInterviewer questions (or prompts) are labeled or separated from\nparticipant responses, as appropriate. This can be done by adding\nquestion text as its own field in the dataset or by adding markers in\nthe transcript. Text Segments Are Ordered and Organized\n\nThe transcript text is ordered according to the flow of conversation.\nSegments are correctly time-sequenced (even if timestamps themselves are\nremoved). Text Is Structured Into a Tidy, Rectangular Format\n\nEach row represents a single speaker turn or unit of analysis (e.g., a\ncomplete response to a question). Data are stored in a rectangular table\n(data frame), with columns for: Session name or group (e.g., \"Educators\"\nor \"Public Health\") Participant ID or role (e.g., \"Participant 1,\"\n\"Facilitator\") Text segment (the response or comment) Any relevant\nmetadata (e.g., discussion section, date) Timestamps and Transcription\nArtifacts Are Removed\n\nAll timestamps (e.g., [00:05:23], (0:12:45)) are deleted unless\nspecifically required for analysis. Automated transcription quirks\n(e.g., repeated words, filler words, auto-captions like â€œ[inaudible]â€)\nare reviewed, cleaned, or flagged. Text Is Consistent in Style and\nFormat\n\nAll text is converted to lowercase, unless case is important for\nanalysis. Spelling errors are corrected when they obscure meaning (but\nregional spellings or participant quirks may be preserved if relevant).\nPunctuation and spacing are standardized (no excessive whitespace,\nmissing periods, etc.). Relevant Identifiers Are Added to the Dataset\n\nIf there are multiple sessions or groups, these are labeled (e.g.,\n\"Educators,\" \"Public Health\"). If there are themes or discussion\nsections (e.g., \"Challenges,\" \"Recommendations\"), these are identified.\nIf codes are pre-assigned for analytic purposes (e.g.,\nâ€œPre-implementation,â€ â€œPost-implementationâ€), they are included in the\ndata structure. ðŸ’¡ How Do We Know When Qualitative Data Are Clean? Here\nare some guiding questions to help determine when qualitative data are\nready for analysis (i.e., clean):\n\nWhat is the plan for coding or analyzing this data?\n\nThe analysis plan (or coding framework) should inform cleaning\ndecisions. For example, if the team plans to do thematic coding, theyâ€™ll\nneed text organized into meaningful speaker turns or responses. What\nneeds to be anonymized?\n\nIdentify any sensitive information that must be redacted or replaced to\nmaintain confidentiality and ensure participant privacy. Are speaker\nturns properly attributed and easy to follow?\n\nEach speakerâ€™s contributions should be clearly labeled, consistently\nformatted, and grouped logically. Are responses to specific questions\nclearly identifiable?\n\nIf interviews or focus groups follow a semi-structured guide, itâ€™s\nimportant to separate questions from responses for clarity in analysis.\nIs the structure of the data appropriate for the analytic tool?\n\nIf the data are being uploaded to Dedoose, NVivo, or another platform,\nthey should follow the required format (e.g., tidy data frame with\nspeaker IDs and group names). Have all unnecessary artifacts been\nremoved?\n\nTime stamps, filler words, and transcription errors that donâ€™t add value\nto the analysis should be removed. Has the cleaned data been reviewed by\nsomeone else (QA check)?\n\nWhenever possible, have another OMNI-ite review the cleaned data for\naccuracy and completeness. âœ¨ Common Issues to Discuss Early in the\nCleaning Process Just like in quantitative data cleaning, clarifying\nexpectations at the start of a project will save time later. For\nqualitative projects, consider these:\n\nWill we analyze both facilitator questions and participant responses, or\njust participant responses? How will we handle overlapping speech,\ninterruptions, or incomplete thoughts? Do we need to standardize\nparticipant roles (e.g., \"Public Health Official\" vs. \"PH Staff\") for\nconsistency? Are we preparing data for manual coding or automated text\nanalysis? Do we need to translate or transcribe non-English responses?\nDo we need to connect text segments with broader context, such as the\ndiscussion theme or section of the focus group? ðŸš€ In the Following\nSections... Weâ€™ll see how these fundamentalsâ€”like tidy qualitative data,\npipes, and regular expressionsâ€”play out in real-world cleaning tasks,\nsuch as:\n\nRemoving timestamps and filler words Labeling speakers and organizing\nsegments Anonymizing sensitive information Structuring text for analysis\nsoftware (Dedoose, NVivo, etc.) âœ… Quick Summary of \"Clean Qualitative\nData\" at OMNI: Clean qualitative data are:\n\nAnonymized Clearly structured and labeled Organized for easy analysis\nFree of unnecessary artifacts Ready for use in coding and interpretation\n\n## How do I report the results of data cleaning?\n\nðŸ“ How to Report the Results of Qualitative Data Cleaning at OMNI\nCleaning qualitative data is an interpretive and decision-heavy process,\nand those decisions need to be transparent. Reporting your cleaning\nprocess helps:\n\nProject leads understand whatâ€™s been done and why. Provide documentation\nin case changes need to be made later. Build trust in the integrity of\nthe cleaned dataset. Support future qualitative coding, interpretation,\nand reporting. Qualitative data cleaning produces resultsâ€”changes to the\ntext or data structureâ€”that should be documented in a clear, shareable\ndata cleaning report.\n\nðŸ“‹ What to Include in a Qualitative Data Cleaning Report 1. Summary of\nthe Dataset You Cleaned Start with an overview:\n\nHow many transcripts or files were cleaned? How many sessions (e.g.,\nfocus groups, interviews) are included? What types of participants are\nrepresented (e.g., educators, public health professionals)? Example:\nThis dataset includes transcripts from 8 focus groups, with 42\nparticipants. Participants represent two stakeholder groups: Educators\n(n = 20) and Public Health Professionals (n = 22).\n\n2.  Anonymization and De-Identification Steps Document what you removed\n    or replaced to protect confidentiality.\n\nWere participant names replaced with IDs (e.g., Participant 01)? Were\norganizations, locations, or personal identifiers removed or redacted?\nWere job titles generalized (e.g., â€œCEOâ€ changed to â€œsenior leaderâ€)?\nExample: Replaced all participant names with Participant IDs (e.g.,\nP01). Removed specific references to organizations and locations (e.g.,\nâ€œat Boulder Community Hospitalâ€ becomes â€œat [hospital]â€). Redacted job\ntitles for anonymity when mentioned alongside unique organizations.\n\n3.  Speaker Labeling and Text Structuring Describe how speakers were\n    labeled and how the transcript was organized.\n\nWere speakers consistently labeled as \"Participant\" and \"Facilitator\"?\nWas each speaker turn separated into its own row or segment? Were\nquestions separated from responses? Example: Speaker turns were labeled\nconsistently as either Facilitator or Participant. Each speaker turn is\nstored as one row in the cleaned dataset, with associated metadata\n(Session name, Speaker role, Discussion section).\n\n4.  Artifacts Removed (Timestamps, Filler Words, etc.) Note what\n    transcription artifacts were removed or edited:\n\nWere timestamps deleted? Were filler words (e.g., â€œum,â€ â€œuhâ€) removed?\nIf so, specify whether this was systematic or case-by-case. Were\ntranscription errors corrected? Example: Removed all timestamps in the\nformat [hh:mm:ss]. Deleted common filler words (â€œum,â€ â€œuhâ€) unless they\ncontributed to participant meaning or tone. Reviewed and corrected\nauto-transcription errors (e.g., â€œDodooseâ€ corrected to â€œDedooseâ€).\n\n5.  Text Standardization and Formatting Summarize standardization steps\n    for readability and consistency:\n\nWas text converted to lowercase? Was spelling corrected? If so, did you\npreserve participant colloquialisms? Were consistent punctuation and\nspacing applied? Example: Converted all text to lowercase for\nconsistency. Standardized punctuation (e.g., added periods to sentence\nends where missing). Corrected spelling errors that obscured meaning but\npreserved participant vernacular and tone where appropriate.\n\n6.  Metadata or Contextual Information Added Note any metadata added to\n    support analysis:\n\nSession name (e.g., â€œEducatorsâ€ vs. â€œPublic Health Professionalsâ€)\nDiscussion section (e.g., â€œChallenges,â€ â€œRecommendationsâ€) Participant\nrole or group designation Example: Added metadata fields to identify\nSession Name, Participant Group (Educator/Public Health), and Discussion\nSection (Barriers, Facilitators, Recommendations).\n\n7.  Key Decisions Made During Cleaning Flag any important decisions that\n    could impact analysis:\n\nIf you excluded any portions of text (e.g., off-topic discussions),\ndocument what was excluded and why. If you made choices about retaining\nor removing interruptions, overlapping speech, or non-verbal cues,\ndescribe the rationale. If you generalized identifying details in ways\nthat may impact interpretation, note this. Example: Excluded\nintroductory small talk (greetings, logistics discussions) from the\nanalysis dataset. Retained overlapping speech where relevant to the\ndiscussion. Generalized certain job titles to preserve anonymity (e.g.,\nâ€œHead Nurseâ€ changed to â€œMedical Staffâ€).\n\n8.  Counts and Summaries Where Relevant When helpful, include counts\n    that summarize:\n\nHow many identifiers were removed? How many sessions, speakers, or\nresponses are in the final dataset? If you organized by themes, how many\nsegments are in each theme? Example: Final cleaned dataset includes 8\nfocus groups, 42 participants, and 620 participant responses across\nthree discussion sections: Challenges (n = 220), Facilitators (n = 200),\nand Recommendations (n = 200).\n\nðŸ’¡ Tips for Reporting Qualitative Data Cleaning Be Transparent Even\nsmall decisions (e.g., standardizing speaker labels) can have big\nimplications during analysis. If youâ€™re unsure whether to document\nsomething, document it!\n\nTake the Perspective of Your Project Lead or Analyst What decisions\nmight they need to revisit later? What context would help them\nunderstand how the data were shaped?\n\nSupport Replicability and Quality Control Your cleaning report should\nmake it easy for another team member to:\n\nUnderstand what was done Re-run the cleaning script Suggest or request\nchanges with full knowledge of the process ðŸ–¼ï¸ Example Summary Table in a\nQualitative Cleaning Report Cleaning Step Action Taken Notes\nAnonymization Removed names, replaced with Participant IDs (P01-P42)\nLocations and job titles generalized Speaker Labeling Labeled as\nFacilitator or Participant Consistent across all sessions Timestamps\nRemoved Deleted all timestamps (hh:mm:ss)\\\nFiller Words Removed \"um,\" \"uh\" except when indicating hesitation\nCase-by-case review Text Standardization Converted to lowercase,\ncorrected major spelling errors Preserved participant language/tone\nMetadata Added Session name, participant group, discussion section\nUseful for subgroup analysis Exclusions Removed introductions, off-topic\ndiscussions Documented in the data log\n\n## Terminology\n\nðŸ“ Relevant Terminology for Qualitative Data Cleaning in R ðŸ”§ Data\nStructure & Format Terms Transcript A written or typed record of spoken\nlanguage from interviews, focus groups, or meetings. Transcripts may\ninclude speaker labels, timestamps, and other artifacts that need\ncleaning.\n\nTurn-Taking Each time a participant or facilitator speaks is called a\n\"turn.\" Clean data often organize these turns into individual rows in a\ndataset.\n\nSegment (or Excerpt) A portion of text, such as a paragraph, sentence,\nor speaker turn, treated as a unit for coding or analysis. Segments are\noften defined by the speaker's response or by topic.\n\nTidy Data Data where:\n\nEach row represents a single observation (e.g., a speaker turn or\nsegment) Each column contains one type of information (e.g., speaker ID,\ntext, session group) Tidy data make it easier to manipulate, clean, and\nanalyze qualitative datasets in R. Rectangular Data Another term for a\ntable or data frame, where rows and columns are used to organize data in\nR.\n\nðŸ—‚ï¸ Qualitative Metadata & Labeling Terms Speaker Label An identifier\nshowing who is speaking (e.g., \"Facilitator,\" \"Participant 1\"). Clean\ndata should use consistent speaker labels.\n\nParticipant ID A unique identifier assigned to participants to protect\nanonymity (e.g., \"P01\"). These are often used in place of names.\n\nSession ID / Group The label identifying the specific interview or focus\ngroup a participant was part of (e.g., \"Session 1 â€“ Educators\").\n\nDiscussion Section / Topic Area A label identifying a portion of the\nconversation (e.g., \"Barriers,\" \"Recommendations\") to help organize\nqualitative data.\n\nâœ‚ï¸ Data Cleaning & Transformation Terms Anonymization /\nDe-Identification The process of removing or replacing personal\nidentifiers (e.g., names, locations, job titles) to protect participant\nprivacy.\n\nStandardization Making text consistent in format (e.g., converting to\nlowercase, consistent punctuation, spacing).\n\nTokenization (Optional depending on your analysis!) Breaking down text\ninto smaller partsâ€”words, sentences, or phrasesâ€”typically for text\nmining. Not always part of standard qualitative coding workflows.\n\nFiltering Removing unnecessary rows or segments (e.g., small talk,\noff-topic responses) from the data.\n\nRecoding Transforming data from one format to another (e.g.,\ngeneralizing job titles or grouping participant roles).\n\nJoin / Merge Combining two datasets based on a shared key (e.g., merging\nparticipant demographic info with transcripts).\n\nPivoting Restructuring data from wide format (many columns) to long\nformat (many rows), or vice versa, to make it easier to analyze or\ndisplay.\n\nðŸ·ï¸ Text Cleaning Terms Timestamps Time markers in transcripts (e.g.,\n[00:12:34]) that need to be removed unless necessary for the analysis.\n\nFiller Words Common speech disfluencies (e.g., \"um,\" \"uh,\" \"like\") that\ncan be removed for clarity, depending on analysis goals.\n\nInaudibles / Transcription Errors Markers like â€œ[inaudible]â€ or machine\ntranscription errors that need to be corrected or flagged.\n\nSpelling and Grammar Standardization Correcting spelling errors that\nmake text difficult to read, while preserving participant voice and tone\nwhere relevant.\n\n# Data cleaning procedures\n\nThe first step we'll need to take is to figure out what kind of document\nyou want to read into R.\n\n## Reading your data into R\n\nFirst, we'll need to read our data into R. Depending on how your raw\ntext is stored, you'll need to take various steps to read in your data\nfor analysis. The goal is to turn any of your text into a dataframe with\nrows and columns of your text responses. In some cases, you may need to\nkeep participant ID columns or other columns if you're doing a\nmixed-method analysis. In other cases, you may be analyzing different\nfocus groups and comparing them to eachother. Whatever you are doing,\nmake sure your dataframe is set up or your analysis. If you are unsure\nabout this, ask Hannah or a member of Qual BPT for some help!\n\nHere is an example of what your data may look like when you first read\nit into R.\n\n![](dirty_data.png)\n\nand here's what we want it to look like (eventually) for most of our\nanalysis needs.\n\n![](clean_data.png)\n\nWith clean data, we can:\n\n-   Compare participants' responses across sessions and discussion\n    sections. We could answer questions like:\n\n    -   What did Educators say about Community Impact vs. Public\n        Health?\"\n\n    -   What did participants across all interviews think about\n        abatement funds?\n\n-   Filter by participant role (e.g., facilitators vs. participants) for\n    targeted analysis. We could answer questions like:\n\n    -    How many participants mentioned that the county should invest\n        in wraparound services across all interviews?\n\n    -   What is the most common barrier in accessing services in the\n        county?\n\n-   Preserve anonymity by removing names and identifiers.\n\n### Zoom transcripts\n\nOne of the main forms of qualitative data we receive includes Zoom transcripts. Below is a function you can use to clean your Zoom transcripts and get them to a tidy format by entering the interviewer name(s), and key phrases used by the interviewer to mark the section of the discussion. For example, an interview might begin with an introduction, then include a discussion of barriers, and a discussion of strengths. We'll likely want to separate these out into sections so our analyses can speak to each section independent of each other, rather than be clumped altogether. \n\n```{r}\n\n# youll need these libraries for this function:\nlibrary(tidyverse)\nlibrary(officer)\nlibrary(stringr)\n\nclean_transcript <- function(file_path,\n                             file_type = c(\".docx\", \".txt\"),\n                             interviewers,\n                             question_list,\n                             section_labels,\n                             session_name) {\n  \n  # Match file_type argument\n  file_type <- match.arg(file_type)\n  \n  # ================================\n  # âœ… 1. Load transcript based on file_type\n  # ================================\n  if (file_type == \".docx\") {\n    doc <- read_docx(file_path)\n    text_data <- docx_summary(doc)\n    df <- text_data %>%\n      dplyr::select(line = doc_index, text)\n  } else if (file_type == \".txt\") {\n    text_lines <- readLines(file_path, encoding = \"UTF-8\")\n    df <- tibble(line = seq_along(text_lines), text = text_lines)\n  } else {\n    stop(\"Unsupported file type. Use '.docx' or '.txt'\")\n  }\n\n  # ================================\n  # âœ… 2. Classify speaker: interviewer vs participant\n  # ================================\n  df <- df %>%\n    mutate(\n      speaker = case_when(\n        str_detect(text, str_c(interviewers, collapse = \"|\")) ~ \"interviewer\",\n        TRUE ~ \"participant\"\n      )\n    ) %>%\n    filter(\n      text != \"\",                      # Remove blank rows\n      !str_detect(text, \"^\\\\d+$\"),     # Remove number-only rows\n      !str_detect(text, \"-->\")         # Remove timestamp markers\n    )\n\n  # ================================\n  # âœ… 3. Extract participant & interviewer names\n  # ================================\n  \n  # Participants\n  unique_participants <- df %>%\n    filter(speaker == \"participant\" & str_detect(text, \":\")) %>%\n    mutate(participant_name = str_extract(text, \"^[^:]+\")) %>%\n    distinct(participant_name) %>%\n    drop_na() %>%\n    mutate(participant_id = paste0(\"P\", row_number()))\n\n  # Assign participant IDs back\n  df <- df %>%\n    mutate(\n      participant_name = if_else(\n        speaker == \"participant\" & str_detect(text, \":\"),\n        str_extract(text, \"^[^:]+\"),\n        NA_character_\n      )\n    ) %>%\n    left_join(unique_participants, by = \"participant_name\") %>%\n    select(-participant_name)\n\n  # Interviewers\n  unique_interviewers <- df %>%\n    filter(speaker == \"interviewer\" & str_detect(text, \":\")) %>%\n    mutate(interviewer_name = str_extract(text, \"^[^:]+\")) %>%\n    distinct(interviewer_name) %>%\n    drop_na() %>%\n    mutate(interviewer_id = paste0(\"I\", row_number()))\n\n  # Assign interviewer IDs back\n  df <- df %>%\n    mutate(\n      interviewer_name = if_else(\n        speaker == \"interviewer\" & str_detect(text, \":\"),\n        str_extract(text, \"^[^:]+\"),\n        NA_character_\n      )\n    ) %>%\n    left_join(unique_interviewers, by = \"interviewer_name\") %>%\n    mutate(\n      participant_id = coalesce(participant_id, interviewer_id)\n    ) %>%\n    select(-interviewer_name, -interviewer_id)\n\n  # ================================\n  # âœ… 4. Clean and Preprocess Text\n  # ================================\n  df <- df %>%\n    mutate(\n      text = str_remove(text, \".*?:\\\\s*\"),   # Remove speaker names (before colon)\n      text = tolower(text),                  # Convert to lowercase\n      text = str_replace_all(text, \"[^a-zA-Z0-9\\\\s]\", \"\"),  # Remove special characters (except spaces)\n      text = iconv(text, from = \"UTF-8\", to = \"ASCII//TRANSLIT\")  # Convert non-ASCII characters\n    )\n\n  # ================================\n  # âœ… 5. Create speaker segments BEFORE detecting questions\n  # ================================\n  df <- df %>%\n    arrange(line) %>%\n    filter(!is.na(participant_id)) %>%\n    mutate(\n      group_id = cumsum(\n        participant_id != lag(participant_id, default = first(participant_id))\n      )\n    ) %>%\n    group_by(group_id) %>%\n    summarize(\n      across(-text, first),                # Keep first of all other columns\n      text = str_c(text, collapse = \" \"),  # Collapse text\n      .groups = \"drop\"\n    ) %>%\n    arrange(line)\n\n  # ================================\n  # âœ… 6. Detect interviewer questions\n  # ================================\n  df <- df %>%\n    mutate(\n      question = if_else(\n        speaker == \"interviewer\" &\n          str_detect(\n            text,\n            regex(str_c(question_list, collapse = \"|\"), ignore_case = TRUE)\n          ),\n        1L,\n        0L\n      )\n    )\n\n  # ================================\n  # âœ… 7. Remove text before first question\n  # ================================\n  first_question_line <- min(df$line[df$question == 1], na.rm = TRUE)\n  \n  df <- df %>%\n    filter(line >= first_question_line)\n\n  # ================================\n  # âœ… 8. Assign section numbers\n  # ================================\n  df <- df %>%\n    mutate(section = cumsum(question == 1))\n\n  # Map section numbers to section labels\n  section_map <- tibble(\n    section = seq_along(section_labels),\n    section_label = section_labels\n  )\n\n  # Join section labels\n  df <- df %>%\n    left_join(section_map, by = \"section\")\n\n  # ================================\n  # âœ… 9. Remove interviewer lines AFTER section labels assigned\n  # ================================\n  df <- df %>%\n    filter(speaker != \"interviewer\") %>%\n    mutate(session = session_name)\n\n  # ================================\n  # âœ… 10. Return final dataframe\n  # ================================\n  final_df <- df %>%\n    select(\n      line,\n      speaker,\n      participant_id,\n      question,\n      section,\n      section_label,\n      text,\n      session\n    )\n\n  return(final_df)\n}\n\n```\n\nAnd when you want to clean the transcripts and mark the interviewer, you can add the names of the interviewers here. \n\nThis function works for Zoom transcripts that are saved as Word documents or .txt files. There are few things you need to specify in the function, including updating the file path, the interviewers, setting your list of questions, adding section labels, and the session name. \n\nThis example comes from the Loudoun County Opioid Abatement project where Shon, Lindsay, Hannah, Luke, Eden, and Arden are staffed, so any of them could have been an interviewer. \n\n@QUALBPT is there anything listed here that may be helpful to add that we might want to analyze or examine?\n@QUALBPT is there ever a case where we would need to analyze the interviewer's language?\n\nIn the case where an interviewer asks a question an exact way, we can enter the question as it is listed on the interview guide. However, this is not always the best way to run an interview when you're following a more relaxed vibe. So, it may be helpful to have the interview guide (or deck, whatever the interviewer used to facilitate the discussion) and the transcript opened to identify the order of discussion and section labels, and to identify where those key markers of the text are going to identify your questions. \n\nWhat is a good example of a question list if the interviewer did not read the question verbatim? Let's imagine the first question listed on the interview guide is \"What kinds of barriers do you think prevent community members from accessing services in the county?\". \n\nBad example: \"accessing services\" this is a bad example because this phrase has been marked as an identifier for a question, so any instance of \"accessing services\" comes up will count the phrase as a question.\n\nGood example: \"barriers do you think prevent community members from accessing services\" it is less likely for someone to have used this exact string of words in the conversation, so we're safe to mark this as a question identifier. \n\n```{r}\n# %%%%%%%%%%%%%%%%%%% List interviewer names %%%%%%%%%%%%%%%%%%%\n# ed_df <- clean_transcript(\n#   file_path      = \"../../../data_collection/Listening Sessions/Transcripts/Education Listening Session Transcript.docx\",\n#   file_type      = \".docx\",\n#   interviewers   = c(\"Shon Reed\", \"Lindsay Houston\", \n#                      \"Hannah Lunkenheimer\", \"Luke Saunders\", \n#                      \"Eden Griffin\", \"Sam Barron\",\n#                      \"Arden Trewartha\"),\n#   question_list  = c(\"1st question\", \n#                      \"how has the opioid crisis impacted schools and universities within Loudoun County\", \n#                      \"opioid abatement fund\",\n#                      \"what are what are other specific examples that are working well\",\n#                      \"current efforts on the treatment and recovery\",\n#                      \"are there any other strategies\",\n#                      \"vision for the future\",\n#                      \"survey that you can complete if you would like\"),\n#   section_labels = c(\"Data check\", \"Community impact\", \"Abatement funds\",\n#                      \"Prevention and harm reduction\", \"Treatment and recovery\",\n#                      \"Other strategies\", \"Vision for the future\", \"Next steps\"),\n#   session_name   = \"education\"\n# )\n\n```\n\n### PDFs\n\n```{r}\nlibrary(pdftools)\nlibrary(tibble)\nlibrary(dplyr)\n\n# # Define the folder where PDFs are saved\n# folder_path <- \"path/to/your/pdf/folder\"\n# \n# # List all PDF files in the folder\n# pdf_files <- list.files(folder_path, pattern = \"\\\\.pdf$\", full.names = TRUE)\n# \n# pdf_data <- pdf_files %>%\n#   map_df(~ tibble(\n#     file = basename(.x),           # Extract file name only\n#     text = paste(pdf_text(.x), collapse = \" \")  # Merge all pages into one text block\n#   ))\n# \n# # View the cleaned data\n# print(pdf_data)\n# \n# pdf_data <- pdf_data %>%\n#   mutate(text = str_replace_all(text, \"\\\\s+\", \" \"))  # Remove extra spaces/newlines\n# \n# print(pdf_data)\n\n\n```\n\n### Excel sheets\n\nOf course, we also tend to ask qualitative questions in some of our surveys at OMNI, and these types of data should be read in like quantitative data and should already be in a clean format if you follow the data cleaning guide (insert link to data cleaning guide).\n\n### @QUALBPT Any other forms of text we use?\n\n```{r}\n# %%%%%%%%%%%%%%% Fix misspelled words %%%%%%%%%%%%%%%\n\nlibrary(hunspell)\n\n# Flag misspelled words\nmisspelled <- cleaned_text %>%\n  mutate(\n    misspelled = !hunspell_check(word),\n    suggestions = map(word, hunspell_suggest)\n  ) %>%\n  filter(misspelled)\n\nhead(misspelled)\n\ncorrected_text <- cleaned_text %>%\n  mutate(word = case_match(\n    word, \n    \"leraning\" ~ \"learning\",\n    .default = word\n  ))\n\nhead(corrected_text)\n\n```\n\n\n# QA Checklist for Qual Cleaning\n\n[ ] Are participant and interviewer roles correctly labeled?\n[ ] Have names, locations, and job titles been de-identified?\n[ ] Are timestamps removed (unless needed for analysis)?\n[ ] Are discussion sections correctly labeled?\n[ ] Has text been standardized (case, punctuation, spacing)?\n[ ] Is the cleaned dataset in a tidy format (one speaker turn per row)?\n[ ] Has the cleaned dataset been reviewed by another team member?\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":{"omni::omni_html_report":{"hypothesis":false}},"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"qual_cleaning_R_guide.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","title":"Cleaning Qualitative Data in R Guide","subtitle":"","author":"Hannah","date":"`r Sys.Date() |> format('%B %d, %Y')`","editor_options":{"chunk_output_type":"console","markdown":{"wrap":72}}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}